<!DOCTYPE html>
<html lang="es" data-theme="light">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="author" content="LyPaw">
  <link rel="icon" type="image/x-icon" href="spriteV/pokebola.png"> 
  <title>PokÃ©dex â€” PomeBall</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet"/>
  <style>
    /* â”€â”€ LIGHT THEME (default) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    :root {
      --bg:         #F0F0F5;
      --surface:    #FFFFFF;
      --card-bg:    #FAFAFA;
      --card-top:   #EFEFEF;
      --border:     #D0D0DC;
      --border-mid: #B8B8CC;
      --text:       #1a1a2e;
      --muted:      #7070A0;
      --topbar-bg:  #CC0000;
      --topbar-txt: #FFFFFF;
      --logo-color: #CC0000;
      --accent:     #CC0000;
      --accent-glow:rgba(204,0,0,0.18);
      --btn-bg:     #EFEFEF;
      --btn-border: #C0C0D0;
      --btn-color:  #7070A0;
      --scan:       rgba(0,0,0,0.02);
      --vignette:   rgba(0,0,0,0.08);
      --header-bg1: #F8F8FF;
      --header-bg2: #F0F0F8;
      --controls-bg:#FAFAFE;
      --stat-track: #E0E0EC;
      --card-num:   #AAAACC;
      --card-gen-c: #CC0000;
      --count-c:    #CC0000;
      --footer-bg:  #F0F0F8;
      --footer-bd:  #D0D0E0;
      --gc-green:   #009933;
      --gc-blue:    #0066CC;
      --gc-teal:    #007799;
      --ataque-bg:  #F0F0FF;
      --ataque-bd:  #C0C0E0;
      --ataque-txt: #5050A0;
    }

    /* â”€â”€ DARK THEME â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    [data-theme="dark"] {
      --bg:         #0d0d14;
      --surface:    #111118;
      --card-bg:    #13131e;
      --card-top:   #1a1422;
      --border:     #2a2a3a;
      --border-mid: #3a3a5a;
      --text:       #E8E8F5;
      --muted:      #5a5a7a;
      --topbar-bg:  #880000;
      --topbar-txt: #FFFFFF;
      --logo-color: #FF3333;
      --accent:     #FF3333;
      --accent-glow:rgba(255,51,51,0.2);
      --btn-bg:     #0d0d1a;
      --btn-border: #2a2a4a;
      --btn-color:  #5a5a7a;
      --scan:       rgba(255,255,255,0.025);
      --vignette:   rgba(0,0,0,0.55);
      --header-bg1: #1a1428;
      --header-bg2: #110e1e;
      --controls-bg:#0f0f1c;
      --stat-track: #1a1a2e;
      --card-num:   #3a3a5a;
      --card-gen-c: #FF3333;
      --count-c:    #FF6666;
      --footer-bg:  #0d0d14;
      --footer-bd:  #1e1e2e;
      --gc-green:   #33CC66;
      --gc-blue:    #3399FF;
      --gc-teal:    #00BBBB;
      --ataque-bg:  #0d0d20;
      --ataque-bd:  #2a2a4a;
      --ataque-txt: #7070A0;
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { background: #000; }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'VT323', monospace;
      min-height: 100vh;
      overflow-x: hidden;
      position: relative;
      transition: background 0.3s, color 0.3s;
    }

    /* CRT scanlines */
    body::before {
      content: '';
      position: fixed; inset: 0; z-index: 999; pointer-events: none;
      background: repeating-linear-gradient(
        0deg,
        transparent, transparent 2px,
        var(--scan) 2px, var(--scan) 4px
      );
    }

    /* Vignette */
    body::after {
      content: '';
      position: fixed; inset: 0; z-index: 998; pointer-events: none;
      background: radial-gradient(ellipse at center, transparent 55%, var(--vignette) 100%);
    }

    /* â”€â”€ HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    header {
      background: linear-gradient(180deg, var(--header-bg1) 0%, var(--header-bg2) 100%);
      border-bottom: 3px solid var(--accent);
      position: relative; z-index: 1;
      padding: 0;
      transition: background 0.3s, border-color 0.3s;
    }

    .gc-topbar {
      background: var(--topbar-bg);
      padding: 0.25rem 0.8rem;
      display: flex; justify-content: space-between; align-items: center;
      transition: background 0.3s;
    }

    .gc-topbar-text {
      font-family: 'Press Start 2P', monospace;
      font-size: 0.42rem; color: var(--topbar-txt);
      letter-spacing: 0.08em;
    }

    /* Theme toggle button */
    .theme-toggle {
      font-family: 'Press Start 2P', monospace; font-size: 0.38rem;
      background: none; border: 1px solid rgba(255,255,255,0.3);
      color: var(--topbar-txt); padding: 0.2rem 0.5rem;
      cursor: pointer; letter-spacing: 0.05em;
      transition: all 0.2s;
    }
    .theme-toggle:hover { background: rgba(255,255,255,0.15); }

    .gc-header-inner {
      padding: 1.2rem 0.8rem;
      display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem;
    }

    .gc-logo {
      font-family: 'Press Start 2P', monospace;
      font-size: clamp(0.9rem, 3vw, 1.4rem);
      color: var(--logo-color);
      text-shadow: 2px 2px 0 rgba(0,0,0,0.15), 0 0 20px var(--accent-glow);
      letter-spacing: 0.08em; line-height: 1.6;
      transition: color 0.3s;
    }

    .gc-logo span {
      display: block; font-size: 0.42rem;
      color: var(--gc-teal);
      letter-spacing: 0.22em; margin-top: 0.2rem;
    }

    .gc-header-right {
      display: flex; flex-direction: column; align-items: flex-end; gap: 0.4rem;
    }

    .gc-count {
      font-family: 'Press Start 2P', monospace; font-size: 0.42rem;
      color: var(--count-c);
    }
    .gc-count em { color: var(--gc-teal); font-style: normal; }

    .gc-dots { display: flex; gap: 0.4rem; }
    .gc-dot {
      width: 10px; height: 10px; border-radius: 50%;
      box-shadow: inset -2px -2px 3px rgba(0,0,0,0.25);
    }

    /* â”€â”€ CONTROLS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .gc-controls {
      background: var(--controls-bg);
      border-bottom: 2px solid var(--border);
      padding: 0.7rem 0.8rem;
      display: flex; flex-wrap: wrap; gap: 0.5rem; align-items: center;
      position: relative; z-index: 1;
      transition: background 0.3s, border-color 0.3s;
    }

    .gc-filter-group {
      display: flex; align-items: center; gap: 0.4rem; flex-wrap: wrap;
    }

    .gc-filter-label {
      font-family: 'Press Start 2P', monospace; font-size: 0.38rem;
      color: var(--muted); letter-spacing: 0.1em; white-space: nowrap;
    }

    .gc-search {
      display: flex; align-items: center; gap: 0.4rem;
      background: var(--surface);
      border: 2px solid var(--border);
      border-radius: 2px; padding: 0.35rem 0.7rem;
      transition: border-color 0.2s, background 0.3s;
    }
    .gc-search:focus-within { border-color: var(--accent); }
    .gc-search input {
      background: none; border: none; outline: none;
      color: var(--text); font-family: 'VT323', monospace;
      font-size: 1.1rem; width: 160px;
      transition: color 0.3s;
    }
    .gc-search input::placeholder { color: var(--muted); }

    .gc-sep { width: 1px; height: 24px; background: var(--border); }

    .gc-filter-row { display: flex; gap: 0.4rem; flex-wrap: wrap; }

    .gc-btn {
      font-family: 'Press Start 2P', monospace; font-size: 0.5rem;
      padding: 0.45rem 0.8rem;
      background: var(--btn-bg);
      border: 2px solid var(--btn-border);
      color: var(--btn-color);
      cursor: pointer; letter-spacing: 0.05em; border-radius: 2px;
      transition: all 0.15s;
    }
    .gc-btn:hover { border-color: var(--accent); color: var(--accent); }
    .gc-btn.active {
      background: var(--surface);
      border-color: var(--accent);
      color: var(--accent);
      box-shadow: 0 0 8px var(--accent-glow);
    }

    /* Botones de tipo â€” badges CSS con colores oficiales */
    .gc-tipo-filter-row { display: flex; gap: 0.3rem; flex-wrap: wrap; align-items: center; }
    .gc-tipo-btn {
      background: var(--tc, #888);
      border: 2px solid transparent;
      border-radius: 2px; padding: 0.28rem 0.55rem;
      cursor: pointer; transition: all 0.15s;
      display: flex; align-items: center; justify-content: center;
      filter: brightness(0.82) saturate(0.9);
    }
    .gc-tipo-btn span {
      font-family: 'Press Start 2P', monospace;
      font-size: 0.36rem;
      color: #fff;
      text-shadow: 1px 1px 0 rgba(0,0,0,0.5);
      letter-spacing: 0.03em;
      white-space: nowrap;
    }
    .gc-tipo-btn:hover {
      filter: brightness(1) saturate(1.1);
      border-color: #fff;
      transform: translateY(-1px);
      box-shadow: 0 3px 8px rgba(0,0,0,0.3);
    }
    .gc-tipo-btn.active {
      filter: brightness(1) saturate(1.2);
      border-color: #fff;
      box-shadow: 0 0 0 1px var(--tc), 0 0 10px var(--tc);
      transform: translateY(-1px);
    }

    /* â”€â”€ GRID â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .gc-grid {
      position: relative; z-index: 1;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(230px, 1fr));
      gap: 1.2rem;
      padding: 1.2rem 0.8rem 3rem;
      max-width: 100%;
    }

    /* â”€â”€ CARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .gc-card {
      background: var(--card-bg);
      border: 2px solid var(--border);
      border-radius: 2px; overflow: hidden;
      cursor: pointer; position: relative;
      transition: transform 0.15s, border-color 0.15s, box-shadow 0.15s, background 0.3s;
      animation: gcIn 0.3s ease both;
    }
    .gc-card:hover {
      transform: translateY(-4px);
      border-color: var(--accent);
      box-shadow: 0 8px 24px rgba(0,0,0,0.15), 0 0 12px var(--accent-glow);
    }
    .gc-card.playing {
      border-color: var(--accent);
      box-shadow: 0 0 0 2px var(--accent), 0 0 20px var(--accent-glow);
      animation: gcIn 0.3s ease both, gcPulse 0.8s ease infinite alternate;
    }

    @keyframes gcIn {
      from { opacity: 0; transform: translateY(12px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    @keyframes gcPulse {
      from { box-shadow: 0 0 0 1px var(--accent), 0 0 10px var(--accent-glow); }
      to   { box-shadow: 0 0 0 2px var(--accent), 0 0 25px var(--accent-glow); }
    }

    .gc-card-bar {
      background: var(--card-top);
      border-bottom: 1px solid var(--border);
      padding: 0.45rem 0.8rem;
      display: flex; justify-content: space-between; align-items: center;
      transition: background 0.3s;
    }
    .gc-card-num {
      font-family: 'Press Start 2P', monospace; font-size: 0.55rem;
      color: var(--card-num);
    }
    .gc-card-gen {
      font-family: 'Press Start 2P', monospace; font-size: 0.5rem;
      color: var(--card-gen-c);
    }

    /* â”€â”€ Layout fijo: imagen 70%, texto 30% â”€â”€ */
    .gc-card {
      display: flex; flex-direction: column;
    }
    .gc-card-img {
      background: radial-gradient(circle at center, var(--accent-glow) 0%, transparent 65%);
      display: flex; justify-content: center; align-items: center;
      position: relative;
      flex: 0 0 175px;   /* altura fija para la zona de imagen â€” igual en todas las cards */
      overflow: hidden;
    }
    .gc-card-img img {
      width: 96px; height: 96px;
      object-fit: contain;
      image-rendering: pixelated; image-rendering: crisp-edges;
      filter: drop-shadow(0 2px 8px rgba(0,0,0,0.2));
      transition: transform 0.2s;
      max-width: 100%; max-height: 100%;  /* nunca desborda la zona */
    }
    .gc-card:hover .gc-card-img img { transform: scale(1.12); }

    /* tamaÃ±os custom por ID se aplican via JS desde sprite_sizes.json */

    .gc-sound {
      position: absolute; bottom: 4px; right: 6px;
      font-size: 0.65rem; opacity: 0; transition: opacity 0.2s;
    }
    .gc-card:hover .gc-sound { opacity: 0.4; }
    .gc-card.playing .gc-sound { opacity: 1; }
    /* â”€â”€ BotÃ³n shiny â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .gc-shiny-btn {
      position: absolute; top: 5px; right: 6px;
      background: none; border: none; cursor: pointer;
      font-size: 0.8rem; opacity: 0;
      transition: opacity 0.2s, transform 0.2s;
      line-height: 1; padding: 2px;
      filter: grayscale(0.4);
      z-index: 2;
    }
    .gc-card:hover .gc-shiny-btn { opacity: 0.75; }
    .gc-shiny-btn.active {
      opacity: 1 !important;
      filter: none;
      animation: shinyPulse 1.4s ease infinite alternate;
    }
    @keyframes shinyPulse {
      from { transform: scale(1);    filter: drop-shadow(0 0 3px gold); }
      to   { transform: scale(1.3);  filter: drop-shadow(0 0 10px gold); }
    }
    .gc-card.shiny .gc-card-img {
      background: radial-gradient(circle at center, rgba(255,215,0,0.2) 0%, transparent 65%);
    }

    .gc-card-body { padding: 0.8rem 0.9rem 1rem; flex: 1; }

    .gc-card-name {
      font-family: 'Press Start 2P', monospace; font-size: 0.65rem;
      color: var(--text); margin-bottom: 0.6rem; line-height: 1.7;
      transition: color 0.3s;
    }

    .gc-tipos { display: flex; gap: 0.3rem; flex-wrap: wrap; margin-bottom: 0.6rem; }
    .gc-tipo {
      font-family: 'Press Start 2P', monospace; font-size: 0.42rem;
      padding: 0.25rem 0.55rem; color: #fff; font-weight: 700; border-radius: 1px;
    }

    .gc-ataques {
      padding-top: 0.5rem;
      border-top: 1px solid var(--border);
      display: flex; flex-wrap: wrap; gap: 0.3rem;
    }
    .gc-ataque {
      font-size: 1rem; color: var(--ataque-txt);
      background: var(--ataque-bg); border: 1px solid var(--ataque-bd);
      padding: 0.1rem 0.45rem; transition: background 0.3s;
    }

    /* â”€â”€ FIX: regiÃ³n en pie de card, sin solaparse con GEN â”€â”€ */
    .gc-region {
      display: block;
      text-align: right;
      font-family: 'Press Start 2P', monospace; font-size: 0.42rem;
      color: var(--muted);
      padding: 0.3rem 0.6rem 0.3rem;
      border-top: 1px solid var(--border);
      background: var(--card-top);
      letter-spacing: 0.05em;
      transition: background 0.3s;
    }

    /* â”€â”€ EMPTY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .gc-empty {
      grid-column: 1/-1; text-align: center;
      padding: 4rem; color: var(--muted);
      font-family: 'Press Start 2P', monospace;
      font-size: 0.6rem; line-height: 2.5;
    }

    /* â”€â”€ FOOTER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    footer {
      position: relative; z-index: 1;
      background: var(--footer-bg);
      border-top: 2px solid var(--footer-bd);
      padding: 1rem 0.8rem;
      display: flex; flex-wrap: wrap; gap: 0.8rem;
      justify-content: space-between; align-items: center;
      transition: background 0.3s;
    }
    .gc-footer-left { font-size: 0.95rem; color: var(--muted); }
    .gc-footer-left a { color: var(--muted); text-decoration: none; }
    .gc-footer-left a:hover { color: var(--accent); }

    .gc-footer-team { display: flex; gap: 0.5rem; flex-wrap: wrap; }
    .gc-footer-team a {
      font-family: 'Press Start 2P', monospace; font-size: 0.35rem;
      color: var(--muted); text-decoration: none;
      border: 1px solid var(--border); padding: 0.25rem 0.5rem;
      transition: all 0.15s;
    }
    .gc-footer-team a:hover { border-color: var(--accent); color: var(--accent); }

    @media (max-width: 600px) {
      .gc-grid { padding: 0.8rem; gap: 0.8rem; }
      .gc-controls { padding: 0.8rem; }
      .gc-topbar { flex-wrap: wrap; gap: 0.3rem; }
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MODAL â€” ESTILO POKÃ‰MON ESMERALDA / GBA
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .modal-overlay {
      position: fixed; inset: 0; z-index: 1000;
      background: rgba(0,0,0,0.9);
      display: flex; justify-content: center; align-items: center;
      padding: 0.5rem;
      opacity: 0; pointer-events: none;
      transition: opacity 0.2s;
    }
    .modal-overlay.open { opacity: 1; pointer-events: all; }

    .modal {
      background: var(--bg);
      border: 3px solid var(--accent);
      width: 100%; max-width: 980px;
      max-height: 96vh; overflow-y: auto;
      transform: scale(0.94);
      transition: transform 0.22s cubic-bezier(.22,.68,0,1.2);
      box-shadow: 0 0 0 1px var(--border-mid), 0 30px 80px rgba(0,0,0,0.8);
    }
    .modal-overlay.open .modal { transform: scale(1); }

    /* â”€â”€ Barra tÃ­tulo â”€â”€ */
    .modal-bar {
      background: var(--topbar-bg);
      height: 50px; padding: 0 1rem 0 1.2rem;
      display: flex; justify-content: space-between; align-items: center;
      border-bottom: 3px solid var(--accent);
      position: sticky; top: 0; z-index: 3;
    }
    .modal-bar-left { display: flex; align-items: center; gap: 0.7rem; }
    .modal-bar-icon {
      width: 9px; height: 9px; border-radius: 50%;
      background: var(--accent); box-shadow: 0 0 10px var(--accent);
      animation: blink 2s ease infinite;
    }
    @keyframes blink {
      0%,100% { opacity: 1; } 50% { opacity: 0.3; }
    }
    .modal-bar-title {
      font-family: 'Press Start 2P', monospace; font-size: 0.65rem;
      color: #fff; letter-spacing: 0.1em;
    }
    .modal-bar-right { display: flex; align-items: center; gap: 0.8rem; }
    .modal-bar-btn-label {
      font-family: 'Press Start 2P', monospace; font-size: 0.38rem;
      color: rgba(255,255,255,0.45); letter-spacing: 0.07em;
    }
    @media (max-width: 600px) { .modal-bar-btn-label { display: none; } }
    .modal-close {
      font-family: 'Press Start 2P', monospace; font-size: 0.6rem;
      background: var(--accent);
      border: 2px solid rgba(255,255,255,0.3);
      color: #fff; padding: 0.5rem 1.2rem; cursor: pointer;
      letter-spacing: 0.08em; transition: opacity 0.15s;
    }
    .modal-close:hover { opacity: 0.85; }

    /* â”€â”€ Cuerpo: 2 paneles â”€â”€ */
    .modal-body {
      display: grid;
      grid-template-columns: 240px 1fr;
      min-height: 460px;
    }

    /* â•â•â• PANEL IZQUIERDO â•â•â• */
    .modal-left {
      background: var(--surface);
      border-right: 3px solid var(--border-mid);
      display: flex; flex-direction: column;
    }

    .modal-sprite-wrap {
      background:
        radial-gradient(circle at 50% 55%, var(--accent-glow) 0%, transparent 68%),
        var(--card-bg);
      display: flex; justify-content: center; align-items: center;
      flex-direction: column; gap: 0.8rem;
      padding: 1.5rem 0 1rem;
      border-bottom: 2px solid var(--border);
      min-height: 200px;
      position: relative;
    }
    .modal-shiny-btn {
      font-family: 'Press Start 2P', monospace; font-size: 0.38rem;
      background: var(--btn-bg);
      border: 2px solid var(--btn-border);
      color: var(--btn-color);
      padding: 0.4rem 0.8rem;
      cursor: pointer; letter-spacing: 0.05em;
      transition: all 0.2s;
    }
    .modal-shiny-btn:hover {
      border-color: gold; color: goldenrod;
    }
    .modal-shiny-btn.active {
      background: var(--surface);
      border-color: gold;
      color: goldenrod;
      box-shadow: 0 0 10px rgba(255,215,0,0.4);
      animation: modalShinyPulse 1.4s ease infinite alternate;
    }
    @keyframes modalShinyPulse {
      from { box-shadow: 0 0 6px rgba(255,215,0,0.3); }
      to   { box-shadow: 0 0 18px rgba(255,215,0,0.7); }
    }
    .modal-sprite-wrap.shiny {
      background:
        radial-gradient(circle at 50% 55%, rgba(255,215,0,0.22) 0%, transparent 68%),
        var(--card-bg);
    }
    .modal-sprite {
      width: 170px; height: 170px;
      object-fit: contain;
      image-rendering: pixelated; image-rendering: crisp-edges;
      filter: drop-shadow(0 6px 18px rgba(0,0,0,0.5));
      transition: transform 0.3s;
    }
    .modal-sprite:hover { transform: scale(1.07); }

    /* tamaÃ±os custom modal se aplican via JS desde sprite_sizes.json */

    /* Tabla ficha */
    .modal-ficha { padding: 0.2rem 0; }
    .modal-ficha-row {
      display: flex; justify-content: space-between; align-items: center;
      padding: 0.55rem 1rem;
      border-bottom: 1px solid var(--border);
    }
    .modal-ficha-row:last-child { border-bottom: none; }
    .modal-ficha-key {
      font-family: 'Press Start 2P', monospace; font-size: 0.38rem;
      color: var(--muted); letter-spacing: 0.05em;
    }
    .modal-ficha-val {
      font-family: 'Press Start 2P', monospace; font-size: 0.42rem;
      color: var(--text); text-align: right;
    }
    .modal-tipos { display: flex; flex-wrap: wrap; gap: 0.3rem; justify-content: flex-end; }
    .modal-tipo {
      font-family: 'Press Start 2P', monospace; font-size: 0.35rem;
      padding: 0.22rem 0.5rem; color: #fff; border-radius: 1px;
    }

    /* â•â•â• PANEL DERECHO â•â•â• */
    .modal-right {
      display: flex; flex-direction: column;
    }

    /* Cabecera del nombre */
    .modal-name-bar {
      background: var(--card-top);
      border-bottom: 2px solid var(--border);
      padding: 0.8rem 1.4rem;
      display: flex; justify-content: space-between; align-items: center;
    }
    .modal-name {
      font-family: 'Press Start 2P', monospace; font-size: 0.85rem;
      color: var(--text); line-height: 1.5;
    }
    .modal-name-num {
      font-family: 'Press Start 2P', monospace; font-size: 0.48rem;
      color: var(--muted);
    }

    /* Grid interior derecho: stats | perfil */
    .modal-right-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      flex: 1;
      border-bottom: 2px solid var(--border);
    }

    .modal-stats-panel {
      padding: 1.2rem 1.4rem;
      border-right: 2px solid var(--border);
    }
    .modal-perfil-panel {
      padding: 1.2rem 1.4rem;
    }

    /* Cabecera de secciÃ³n */
    .modal-section-hdr {
      display: flex; align-items: center; gap: 0.5rem;
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 2px solid var(--border);
    }
    .modal-section-dot {
      width: 6px; height: 6px; border-radius: 50%;
      background: var(--accent); flex-shrink: 0;
      box-shadow: 0 0 5px var(--accent);
    }
    .modal-section-title {
      font-family: 'Press Start 2P', monospace; font-size: 0.48rem;
      color: var(--accent); letter-spacing: 0.1em;
    }

    /* Stats â€” 6 barras estilo Bulbapedia */
    .modal-stat { margin-bottom: 0.5rem; }
    .modal-stat-row {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 0.2rem;
    }
    .modal-stat-lbl {
      font-family: 'Press Start 2P', monospace; font-size: 0.37rem;
      color: var(--muted); min-width: 55px;
    }
    .modal-stat-num {
      font-family: 'Press Start 2P', monospace; font-size: 0.43rem;
      min-width: 26px; text-align: right;
    }
    .modal-stat-bar-wrap {
      flex: 1; height: 9px;
      background: var(--stat-track);
      border: 1px solid var(--border); border-radius: 1px; overflow: hidden;
      margin: 0 0.45rem;
    }
    .modal-stat-bar-fill {
      height: 100%; width: 0%; border-radius: 1px;
      transition: width 0.65s cubic-bezier(.22,.68,0,1.2);
    }
    .modal-stat-bar-fill.stat-low   { background: #e05050; }
    .modal-stat-bar-fill.stat-mid   { background: #d4a020; }
    .modal-stat-bar-fill.stat-high  { background: #40a840; }
    .modal-stat-bar-fill.stat-great { background: #2288CC; }
    .modal-stat-total {
      display: flex; justify-content: space-between; align-items: center;
      padding-top: 0.45rem; margin-top: 0.25rem;
      border-top: 1px solid var(--border);
    }
    .modal-stat-total-lbl {
      font-family: 'Press Start 2P', monospace; font-size: 0.37rem; color: var(--muted);
    }
    .modal-stat-total-num {
      font-family: 'Press Start 2P', monospace; font-size: 0.48rem; color: var(--accent);
    }

    /* Ataques */
    .modal-ataques-section { margin-top: 0.8rem; padding-top: 0.8rem; border-top: 2px solid var(--border); }
    .modal-ataques { display: flex; flex-wrap: wrap; gap: 0.4rem; margin-top: 0.6rem; }
    .modal-ataque {
      font-family: 'Press Start 2P', monospace; font-size: 0.38rem;
      color: var(--text); background: var(--card-bg);
      border: 1px solid var(--border-mid);
      padding: 0.35rem 0.6rem; letter-spacing: 0.03em;
    }

    /* Perfil (placeholder editable) */
    .modal-perfil-fields { display: flex; flex-direction: column; gap: 0.6rem; }
    .modal-perfil-field {
      display: flex; gap: 0.5rem; align-items: flex-start;
      padding: 0.5rem 0.7rem;
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-left: 3px solid var(--border-mid);
    }
    .modal-perfil-field.accent { border-left-color: var(--accent); }
    .modal-perfil-label {
      font-family: 'Press Start 2P', monospace; font-size: 0.35rem;
      color: var(--muted); white-space: nowrap; padding-top: 0.15rem;
      min-width: 60px;
    }
    .modal-perfil-value {
      font-family: 'VT323', monospace; font-size: 1.15rem;
      color: var(--text); line-height: 1.4;
    }
    .modal-perfil-value.placeholder { color: var(--muted); font-style: italic; }

    /* Curiosidades â€” fila inferior full-width */
    .modal-curiosidades-section {
      padding: 1.2rem 1.4rem;
    }
    .modal-curiosidades-list { display: flex; flex-direction: column; gap: 0.6rem; margin-top: 0.2rem; }
    .modal-curiosidad-item {
      display: flex; gap: 0.7rem; align-items: flex-start;
      padding: 0.7rem 0.9rem;
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-left: 3px solid var(--accent);
    }
    .modal-curiosidad-icon { font-size: 1rem; flex-shrink: 0; padding-top: 0.1rem; }
    .modal-curiosidad-text {
      font-family: 'VT323', monospace; font-size: 1.2rem;
      color: var(--text); line-height: 1.5;
    }
    .modal-no-curiosidades {
      font-family: 'VT323', monospace; font-size: 1.1rem;
      color: var(--muted); font-style: italic;
    }

    /* â”€â”€ Pie HUD â”€â”€ */
    .modal-footer {
      height: 40px;
      background: var(--card-top);
      border-top: 2px solid var(--border);
      display: flex; align-items: center; justify-content: space-between;
      padding: 0 1.4rem;
    }
    .modal-footer-hint {
      font-family: 'Press Start 2P', monospace; font-size: 0.35rem;
      color: var(--muted); letter-spacing: 0.08em;
    }
    .modal-footer-keys { display: flex; gap: 0.5rem; }
    .modal-key {
      font-family: 'Press Start 2P', monospace; font-size: 0.3rem;
      color: var(--muted); border: 1px solid var(--border-mid);
      padding: 0.1rem 0.4rem; background: var(--btn-bg);
    }

    @media (max-width: 760px) {
      .modal-body { grid-template-columns: 1fr; }
      .modal-left { border-right: none; border-bottom: 3px solid var(--border-mid); }
      .modal-right-grid { grid-template-columns: 1fr; }
      .modal-stats-panel { border-right: none; border-bottom: 2px solid var(--border); }
      .modal-sprite { width: 130px; height: 130px; object-fit: contain; }
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SPRITE VIEWER
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .modal-sprite-hint {
      font-family: 'Press Start 2P', monospace; font-size: 0.28rem;
      color: var(--muted); letter-spacing: 0.06em;
      opacity: 0; transition: opacity 0.2s;
    }
    .modal-sprite-wrap:hover .modal-sprite-hint { opacity: 1; }

    /* â”€â”€ Pokeball loader â”€â”€ */
    .pk-loader {
      position: absolute;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center; gap: 0.6rem;
      pointer-events: none;
      opacity: 0; transition: opacity 0.15s;
    }
    .pk-loader.visible { opacity: 1; }
    .pk-loader-ball {
      width: 48px; height: 48px;
      animation: pkSpin 0.9s linear infinite;
    }
    .pk-loader-txt {
      font-family: 'Press Start 2P', monospace; font-size: 0.3rem;
      color: var(--muted); letter-spacing: 0.1em;
      animation: pkBlink 0.9s ease infinite alternate;
    }
    @keyframes pkSpin {
      from { transform: rotate(0deg); }
      to   { transform: rotate(360deg); }
    }
    @keyframes pkBlink {
      from { opacity: 0.3; }
      to   { opacity: 1; }
    }

    /* Ocultar sprite mientras carga */
    .modal-sprite.loading { opacity: 0; }
    .modal-sprite { transition: opacity 0.2s; }
    .sv-img.loading { opacity: 0; }
    .sv-img { transition: opacity 0.2s; }

    .sv-overlay {
      position: fixed; inset: 0; z-index: 1100;
      background: rgba(0,0,0,0.95);
      display: flex; justify-content: center; align-items: center;
      padding: 1rem;
      opacity: 0; pointer-events: none;
      transition: opacity 0.2s;
    }
    .sv-overlay.open { opacity: 1; pointer-events: all; }

    .sv-box {
      background: var(--bg);
      border: 3px solid var(--accent);
      width: 100%; max-width: 760px;
      transform: scale(0.92);
      transition: transform 0.22s cubic-bezier(.22,.68,0,1.2);
      box-shadow: 0 0 0 1px var(--border-mid), 0 30px 80px rgba(0,0,0,0.9);
    }
    .sv-overlay.open .sv-box { transform: scale(1); }

    .sv-bar {
      background: var(--topbar-bg);
      height: 48px; padding: 0 1rem 0 1.2rem;
      display: flex; justify-content: space-between; align-items: center;
      border-bottom: 3px solid var(--accent);
    }
    .sv-bar-left { display: flex; align-items: center; gap: 0.7rem; }
    .sv-bar-title {
      font-family: 'Press Start 2P', monospace; font-size: 0.55rem;
      color: #fff; letter-spacing: 0.08em;
    }

    .sv-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0;
    }

    .sv-cell {
      display: flex; flex-direction: column; align-items: center;
      padding: 2rem 1rem 1.8rem;
      border-right: 2px solid var(--border);
    }
    .sv-cell:nth-child(2) { border-right: none; }

    .sv-cell-label {
      font-family: 'Press Start 2P', monospace; font-size: 0.45rem;
      color: var(--muted); letter-spacing: 0.08em;
      margin-bottom: 1.4rem; text-align: center;
    }
    .sv-shiny-cell .sv-cell-label { color: goldenrod; }

    .sv-img-wrap {
      background: radial-gradient(circle at center, var(--accent-glow) 0%, transparent 65%);
      border: 2px solid var(--border);
      display: flex; justify-content: center; align-items: center;
      width: 220px; height: 220px;
    }
    .sv-img-wrap-lg {
      width: 300px; height: 300px;
    }
    .sv-img-wrap-shiny {
      background: radial-gradient(circle at center, rgba(255,215,0,0.15) 0%, transparent 65%);
      border-color: rgba(255,215,0,0.3);
    }

    .sv-img {
      width: 180px; height: 180px;
      object-fit: contain;
      image-rendering: pixelated; image-rendering: crisp-edges;
      filter: drop-shadow(0 4px 14px rgba(0,0,0,0.5));
      transition: transform 0.25s;
    }
    .sv-img:hover { transform: scale(1.1); }
    .sv-img-lg {
      width: 240px; height: 240px;
    }

    .sv-footer {
      height: 38px;
      background: var(--card-top);
      border-top: 2px solid var(--border);
      display: flex; align-items: center; justify-content: space-between;
      padding: 0 1.2rem;
    }

    @media (max-width: 600px) {
      .sv-grid { grid-template-columns: 1fr; }
      .sv-cell { border-right: none; }
      .sv-cell:nth-child(3) { border-bottom: 2px solid var(--border); }
      .sv-img-wrap { width: 160px; height: 160px; }
      .sv-img { width: 130px; height: 130px; }
    }
  </style>
</head>
<body>

<header>
  <div class="gc-topbar">
    <span class="gc-topbar-text">POKÃ‰DEX v1.0 â€” INSERT CARTRIDGE</span>
    <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()">â— TEMA</button>
  </div>
  <div class="gc-header-inner">
    <div>
      <div class="gc-logo">
        POKÃ‰DEX | PomeBall
        <span>SELECCIONA TU INICIAL</span>
      </div>
    </div>
    <div class="gc-header-right">
      <div class="gc-count">MOSTRANDO <em id="count">0</em> POKÃ‰MON</div>
      <div class="gc-dots">
        <div class="gc-dot" style="background:#CC0000"></div>
        <div class="gc-dot" style="background:#FFE000"></div>
        <div class="gc-dot" style="background:#33CC66"></div>
        <div class="gc-dot" style="background:#3399FF"></div>
      </div>
    </div>
  </div>
</header>

<div class="gc-controls">
  <!-- BÃºsqueda -->
  <div class="gc-search">
    <span>ğŸ”</span>
    <input type="text" id="search" placeholder="BUSCAR..."/>
  </div>
  <div class="gc-sep"></div>
  <!-- Filtro por ID -->
  <div class="gc-search">
    <span style="font-family:'Press Start 2P',monospace;font-size:0.55rem;color:var(--muted)">#</span>
    <input type="number" id="searchId" placeholder="ID..." min="1" style="width:70px"/>
  </div>
  <div class="gc-sep"></div>

  <!-- Filtros por generaciÃ³n (multi-select) -->
  <div class="gc-filter-group">
    <span class="gc-filter-label">GEN</span>
    <div class="gc-filter-row" id="genFilters">
      <button class="gc-btn" data-filter="gen:1">I</button>
      <button class="gc-btn" data-filter="gen:2">II</button>
      <button class="gc-btn" data-filter="gen:3">III</button>
      <button class="gc-btn" data-filter="gen:4">IV</button>
      <button class="gc-btn" data-filter="gen:5">V</button>
      <button class="gc-btn" data-filter="gen:6">VI</button>
      <button class="gc-btn" data-filter="gen:7">VII</button>
      <button class="gc-btn" data-filter="gen:8">VIII</button>
      <button class="gc-btn" data-filter="gen:9">IX</button>
    </div>
  </div>

  <div class="gc-sep"></div>

  <!-- Filtros por tipo (multi-select) con badges CSS -->
  <div class="gc-filter-group">
    <span class="gc-filter-label">TIPO</span>
    <div class="gc-filter-row gc-tipo-filter-row" id="tipoFilters">
      <button class="gc-tipo-btn" data-filter="tipo:normal"    style="--tc:#9FA19F"><span>NORMAL</span></button>
      <button class="gc-tipo-btn" data-filter="tipo:fuego"     style="--tc:#E62829"><span>FUEGO</span></button>
      <button class="gc-tipo-btn" data-filter="tipo:agua"      style="--tc:#2980EF"><span>AGUA</span></button>
      <button class="gc-tipo-btn" data-filter="tipo:planta"    style="--tc:#3FA129"><span>PLANTA</span></button>
      <button class="gc-tipo-btn" data-filter="tipo:electrico" style="--tc:#FAC000"><span>ELÃ‰CT.</span></button>
      <button class="gc-tipo-btn" data-filter="tipo:hielo"     style="--tc:#3DCEF3"><span>HIELO</span></button>
      <button class="gc-tipo-btn" data-filter="tipo:lucha"     style="--tc:#FF8000"><span>LUCHA</span></button>
      <button class="gc-tipo-btn" data-filter="tipo:veneno"    style="--tc:#9141CB"><span>VENENO</span></button>
      <button class="gc-tipo-btn" data-filter="tipo:tierra"    style="--tc:#915121"><span>TIERRA</span></button>
      <button class="gc-tipo-btn" data-filter="tipo:volador"   style="--tc:#81B9EF"><span>VOLAD.</span></button>
      <button class="gc-tipo-btn" data-filter="tipo:psiquico"  style="--tc:#EF4179"><span>PSÃQ.</span></button>
      <button class="gc-tipo-btn" data-filter="tipo:bicho"     style="--tc:#91A119"><span>BICHO</span></button>
      <button class="gc-tipo-btn" data-filter="tipo:roca"      style="--tc:#AFA981"><span>ROCA</span></button>
      <button class="gc-tipo-btn" data-filter="tipo:fantasma"  style="--tc:#704170"><span>FANT.</span></button>
      <button class="gc-tipo-btn" data-filter="tipo:dragÃ³n"   style="--tc:#5060E1"><span>DRAGÃ“N</span></button>
      <button class="gc-tipo-btn" data-filter="tipo:siniestro" style="--tc:#624D4E"><span>SINIST.</span></button>
      <button class="gc-tipo-btn" data-filter="tipo:acero"     style="--tc:#60A1B8"><span>ACERO</span></button>
      <button class="gc-tipo-btn" data-filter="tipo:hada"      style="--tc:#EF70EF"><span>HADA</span></button>
    </div>
  </div>
</div>

<div class="gc-grid" id="grid"></div>

<div class="modal-overlay" id="modalOverlay" onclick="closeModalOutside(event)">
  <div class="modal" id="modal">

    <!-- Barra tÃ­tulo -->
    <div class="modal-bar">
      <div class="modal-bar-left">
        <div class="modal-bar-icon"></div>
        <span class="modal-bar-title" id="modalBarTitle">INFO. POKÃ‰MON</span>
      </div>
      <div class="modal-bar-right">
        <span class="modal-bar-btn-label">[ ESC ] CERRAR</span>
        <button class="modal-close" onclick="closeModal()">âœ• SALIR</button>
      </div>
    </div>

    <!-- Cuerpo: izquierda + derecha -->
    <div class="modal-body">

      <!-- â•â•â• PANEL IZQUIERDO â•â•â• -->
      <div class="modal-left">
        <div class="modal-sprite-wrap">
          <img class="modal-sprite" id="modalSprite" src="" alt="" title="Ver galerÃ­a de sprites" onclick="openSpriteViewer()" style="cursor:zoom-in"/>
          <div class="pk-loader" id="modalLoader">
            <svg class="pk-loader-ball" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
              <circle cx="50" cy="50" r="48" fill="none" stroke="var(--border)" stroke-width="4"/>
              <path d="M2,50 A48,48 0 0,1 98,50" fill="#CC0000"/>
              <path d="M2,50 A48,48 0 0,0 98,50" fill="#ffffff"/>
              <rect x="2" y="47" width="96" height="6" fill="#222"/>
              <circle cx="50" cy="50" r="12" fill="#222" stroke="#222" stroke-width="2"/>
              <circle cx="50" cy="50" r="7" fill="var(--bg)" stroke="var(--border)" stroke-width="2"/>
            </svg>
            <span class="pk-loader-txt">CARGANDO...</span>
          </div>
          <span class="modal-sprite-hint">[ CLIC PARA VER GALERÃA ]</span>
          <button class="modal-shiny-btn" id="modalShinyBtn" title="Ver shiny" onclick="toggleModalShiny()">âœ¨ SHINY</button>
        </div>
        <div class="modal-ficha">
          <div class="modal-ficha-row">
            <span class="modal-ficha-key">NÂº</span>
            <span class="modal-ficha-val" id="modalNum"></span>
          </div>
          <div class="modal-ficha-row">
            <span class="modal-ficha-key">TIPO</span>
            <div class="modal-tipos" id="modalTipos"></div>
          </div>
          <div class="modal-ficha-row">
            <span class="modal-ficha-key">REGIÃ“N</span>
            <span class="modal-ficha-val" id="modalRegion"></span>
          </div>
          <div class="modal-ficha-row">
            <span class="modal-ficha-key">GEN</span>
            <span class="modal-ficha-val" id="modalGen" style="color:var(--accent)"></span>
          </div>
        </div>
      </div>

      <!-- â•â•â• PANEL DERECHO â•â•â• -->
      <div class="modal-right">

        <!-- Nombre + nÃºmero -->
        <div class="modal-name-bar">
          <span class="modal-name" id="modalName"></span>
          <span class="modal-name-num" id="modalNameNum"></span>
        </div>

        <!-- Grid stats | perfil -->
        <div class="modal-right-grid">

          <!-- Stats + ataques -->
          <div class="modal-stats-panel">
            <div class="modal-section-hdr">
              <div class="modal-section-dot"></div>
              <span class="modal-section-title">ESTADÃSTICAS BASE</span>
            </div>
            <div id="modalStats"></div>
            <div class="modal-ataques-section">
              <div class="modal-section-hdr" style="margin-bottom:0.5rem">
                <div class="modal-section-dot"></div>
                <span class="modal-section-title">MOVIMIENTOS</span>
              </div>
              <div class="modal-ataques" id="modalAtaques"></div>
            </div>
          </div>

          <!-- Perfil -->
          <div class="modal-perfil-panel">
            <div class="modal-section-hdr">
              <div class="modal-section-dot"></div>
              <span class="modal-section-title">PERFIL</span>
            </div>
            <div class="modal-perfil-fields">
              <div class="modal-perfil-field accent">
                <span class="modal-perfil-label">ALTURA</span>
                <span class="modal-perfil-value" id="modalAltura"></span>
              </div>
              <div class="modal-perfil-field accent">
                <span class="modal-perfil-label">PESO</span>
                <span class="modal-perfil-value" id="modalPeso"></span>
              </div>
              <div class="modal-perfil-field accent">
                <span class="modal-perfil-label">ESPECIE</span>
                <span class="modal-perfil-value" id="modalEspecie"></span>
              </div>
              <div class="modal-perfil-field">
                <span class="modal-perfil-label">DESCRIPCIÃ“N</span>
                <span class="modal-perfil-value" id="modalDescripcion"></span>
              </div>
            </div>
          </div>

        </div>

        <!-- Curiosidades â€” fila inferior -->
        <div class="modal-curiosidades-section">
          <div class="modal-section-hdr">
            <div class="modal-section-dot"></div>
            <span class="modal-section-title">DATOS CURIOSOS</span>
          </div>
          <div class="modal-curiosidades-list" id="modalCuriosidades"></div>
        </div>

      </div>
    </div>

    <!-- Pie HUD -->
    <div class="modal-footer">
      <span class="modal-footer-hint">POMEBALL â€” POKÃ‰DEX SYSTEM v1.0</span>
    </div>

  </div>
</div>

<footer>
  <div class="gc-footer-left">
    SPRITES: <a href="https://pokeapi.co" target="_blank">POKEAPI.CO</a> Â· <a href="https://pokemonshowdown.com" target="_blank">POKEMON SHOWDOWN</a>
    &nbsp;Â·&nbsp; PomeBall Â© 2026
  </div>
  <div class="gc-footer-team">
    <a href="https://github.com/LyPaw" target="_blank">LyPaw</a>
    <a href="https://github.com/CodeDiegoF" target="_blank">CodeDiegoF</a>
    <a href="https://github.com/EvoXgamer-14" target="_blank">EvoXgamer</a>
    <a href="https://github.com/FranJFM" target="_blank">FranJFM</a>
  </div>
</footer>

<!-- â•â•â• SPRITE VIEWER OVERLAY â•â•â• -->
<div class="sv-overlay" id="svOverlay" onclick="closeSVOutside(event)">
  <div class="sv-box">
    <div class="sv-bar">
      <div class="sv-bar-left">
        <div class="modal-bar-icon"></div>
        <span class="sv-bar-title">GALERÃA DE SPRITES â€” <span id="svPokeName"></span></span>
      </div>
      <button class="modal-close" onclick="closeSpriteViewer()">âœ• CERRAR</button>
    </div>
    <div class="sv-grid">
      <div class="sv-cell">
        <div class="sv-cell-label">NORMAL</div>
        <div class="sv-img-wrap sv-img-wrap-lg" style="position:relative">
          <div class="pk-loader visible" id="svFrontLoader">
            <svg class="pk-loader-ball" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
              <circle cx="50" cy="50" r="48" fill="none" stroke="var(--border)" stroke-width="4"/>
              <path d="M2,50 A48,48 0 0,1 98,50" fill="#CC0000"/>
              <path d="M2,50 A48,48 0 0,0 98,50" fill="#ffffff"/>
              <rect x="2" y="47" width="96" height="6" fill="#222"/>
              <circle cx="50" cy="50" r="12" fill="#222" stroke="#222" stroke-width="2"/>
              <circle cx="50" cy="50" r="7" fill="var(--bg)" stroke="var(--border)" stroke-width="2"/>
            </svg>
            <span class="pk-loader-txt">CARGANDO...</span>
          </div>
          <img class="sv-img sv-img-lg loading" id="svFront" src="" alt="Frente normal"/>
        </div>
      </div>
      <div class="sv-cell sv-shiny-cell">
        <div class="sv-cell-label">âœ¨ SHINY</div>
        <div class="sv-img-wrap sv-img-wrap-shiny sv-img-wrap-lg" style="position:relative">
          <div class="pk-loader visible" id="svShinyLoader">
            <svg class="pk-loader-ball" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
              <circle cx="50" cy="50" r="48" fill="none" stroke="rgba(255,215,0,0.4)" stroke-width="4"/>
              <path d="M2,50 A48,48 0 0,1 98,50" fill="goldenrod"/>
              <path d="M2,50 A48,48 0 0,0 98,50" fill="#fffbe6"/>
              <rect x="2" y="47" width="96" height="6" fill="#222"/>
              <circle cx="50" cy="50" r="12" fill="#222" stroke="#222" stroke-width="2"/>
              <circle cx="50" cy="50" r="7" fill="var(--bg)" stroke="rgba(255,215,0,0.5)" stroke-width="2"/>
            </svg>
            <span class="pk-loader-txt" style="color:goldenrod">CARGANDO...</span>
          </div>
          <img class="sv-img sv-img-lg loading" id="svShinyFront" src="" alt="Frente shiny"/>
        </div>
      </div>
    </div>
    <div class="sv-footer">
      <span class="modal-footer-hint">POMEBALL â€” SPRITE VIEWER v1.0</span>
      <span class="modal-key">ESC CERRAR</span>
    </div>
  </div>
</div>

<script>
  // â”€â”€ Theme toggle â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function toggleTheme() {
    const html = document.documentElement;
    const isDark = html.getAttribute('data-theme') === 'dark';
    html.setAttribute('data-theme', isDark ? 'light' : 'dark');
    document.getElementById('themeToggle').textContent = isDark ? 'â— TEMA' : 'â—‘ TEMA';
    localStorage.setItem('pk-theme', isDark ? 'light' : 'dark');
  }

  const saved = localStorage.getItem('pk-theme');
  if (saved) {
    document.documentElement.setAttribute('data-theme', saved);
    if (saved === 'dark') document.getElementById('themeToggle').textContent = 'â—‘ TEMA';
  }

  // â”€â”€ Convierte nombre de PokÃ©mon a slug de PokÃ©mon Showdown â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // Ej: "Bulbasaur" â†’ "bulbasaur"
  //     "Farfetch'd" â†’ "farfetchd"
  //     "Nidoranâ™€"  â†’ "nidoranf"
  //     "Mr. Mime"   â†’ "mrmime"
  //     "FlabÃ©bÃ©"    â†’ "flabebe"
  //     "Porygon-Z"  â†’ "porygonz"
  function toShowdownName(nombre) {
    return nombre
      .toLowerCase()
      .normalize('NFD')               // descompone caracteres con tilde (Ã© â†’ e + Ì)
      .replace(/[\u0300-\u036f]/g, '') // elimina los diacrÃ­ticos (tildes, etc.)
      .replace(/â™€/g, 'f')             // sÃ­mbolo femenino â†’ f
      .replace(/â™‚/g, 'm')             // sÃ­mbolo masculino â†’ m
      .replace(/[^a-z0-9]/g, '');     // elimina todo lo que no sea letra/nÃºmero
  }

  // â”€â”€ URLs de sprites normales â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // Prioridad: Showdown animated GIF â†’ BW animated GIF â†’ PNG estÃ¡tico
  const SPRITE_SHOWDOWN = nombre =>
    `https://play.pokemonshowdown.com/sprites/ani/${toShowdownName(nombre)}.gif`;

  const SPRITE_BW = id =>
    `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/versions/generation-v/black-white/animated/${id}.gif`;

  const SPRITE_PNG = id =>
    `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${id}.png`;

  // setSpriteWithFallback: Showdown â†’ BW animated â†’ PNG estÃ¡tico
  function setSpriteWithFallback(imgEl, id, nombre, loaderEl) {
    const pokeName = nombre || imgEl.alt || String(id);
    if (loaderEl) loaderEl.classList.add('visible');
    imgEl.classList.add('loading');
    const onLoaded = () => {
      imgEl.classList.remove('loading');
      if (loaderEl) loaderEl.classList.remove('visible');
      imgEl.onload = null;
    };
    imgEl.onload = onLoaded;
    imgEl.src = SPRITE_SHOWDOWN(pokeName);
    imgEl.onerror = function () {
      this.onerror = null;
      this.src = SPRITE_BW(id);
      this.onerror = function () {
        this.onerror = null;
        this.src = SPRITE_PNG(id);
      };
    };
  }

  // â”€â”€ URLs de sprites shiny â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const SPRITE_SHINY_SD = nombre =>
    `https://play.pokemonshowdown.com/sprites/ani-shiny/${toShowdownName(nombre)}.gif`;

  const SPRITE_SHINY_BW = id =>
    `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/versions/generation-v/black-white/animated/shiny/${id}.gif`;

  const SPRITE_SHINY_PNG = id =>
    `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/shiny/${id}.png`;

  // setShinyWithFallback: Showdown shiny â†’ BW shiny â†’ PNG shiny estÃ¡tico
  function setShinyWithFallback(imgEl, id, nombre, loaderEl) {
    const pokeName = nombre || imgEl.alt || String(id);
    if (loaderEl) loaderEl.classList.add('visible');
    imgEl.classList.add('loading');
    const onLoaded = () => {
      imgEl.classList.remove('loading');
      if (loaderEl) loaderEl.classList.remove('visible');
      imgEl.onload = null;
    };
    imgEl.onload = onLoaded;
    imgEl.src = SPRITE_SHINY_SD(pokeName);
    imgEl.onerror = function () {
      this.onerror = null;
      this.src = SPRITE_SHINY_BW(id);
      this.onerror = function () {
        this.onerror = null;
        this.src = SPRITE_SHINY_PNG(id);
      };
    };
  }

  // â”€â”€ Toggle shiny en card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function toggleShiny(btn, id, nombre) {
    const card    = btn.closest('.gc-card');
    const img     = card.querySelector('img[data-id]');
    const isShiny = btn.classList.contains('active');
    if (isShiny) {
      btn.classList.remove('active');
      card.classList.remove('shiny');
      btn.title = 'Ver shiny';
      setSpriteWithFallback(img, id, nombre);
    } else {
      btn.classList.add('active');
      card.classList.add('shiny');
      btn.title = 'Ver normal';
      setShinyWithFallback(img, id, nombre);
    }
  }

  // â”€â”€ Sonido â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const CRY_URL = id =>
    `https://raw.githubusercontent.com/PokeAPI/cries/main/cries/pokemon/latest/${id}.ogg`;

  let currentAudio = null;

  function playSound(id, cardEl) {
    if (currentAudio) {
      currentAudio.pause();
      currentAudio.currentTime = 0;
      document.querySelectorAll('.gc-card.playing').forEach(c => c.classList.remove('playing'));
    }
    const audio = new Audio(CRY_URL(id));
    currentAudio = audio;
    cardEl.classList.add('playing');
    audio.play().catch(() => {});
    audio.onended = () => cardEl.classList.remove('playing');
  }

  const TIPO_COLORS = {
    fuego:'#e05010', agua:'#2288CC', planta:'#338833', veneno:'#8844AA',
    normal:'#888860', electrico:'#BB9900', tierra:'#AA7740', roca:'#887720',
    bicho:'#667700', fantasma:'#553377', acero:'#7788AA', hielo:'#5599AA',
    lucha:'#993322', psiquico:'#CC3366', dragÃ³n:'#5522CC', siniestro:'#554433', hada:'#BB5577',
  };

  let allPokemons = [];
  let currentSearch   = '';
  let currentSearchId = '';
  let activeGens   = new Set();
  let activeTipos  = new Set();

  let SPRITE_SIZES = {};

  async function loadPokemons() {
    try {
      const [pokemonsRes, perfilesRes, curiosidadesRes, sizesRes] = await Promise.all([
        fetch('pokemons.json'),
        fetch('perfiles.json'),
        fetch('curiosidades.json'),
        fetch('sprite_sizes.json'),
      ]);
      allPokemons  = await pokemonsRes.json();
      PERFILES     = await perfilesRes.json();
      CURIOSIDADES = await curiosidadesRes.json();
      SPRITE_SIZES = await sizesRes.json();
      render();
    } catch (e) {
      document.getElementById('grid').innerHTML =
        '<div class="gc-empty">ERROR: NO SE PUDO CARGAR<br>pokemons.json / perfiles.json / curiosidades.json</div>';
    }
  }

  function render() {
    const grid = document.getElementById('grid');
    const q    = currentSearch.toLowerCase();

    const filtered = allPokemons.filter(p => {
      const matchSearch = !q || p.nombre.toLowerCase().includes(q);
      const matchId     = !currentSearchId || p.id === parseInt(currentSearchId);
      const matchGen    = activeGens.size  === 0 || activeGens.has(p.generacion);
      const matchTipo   = activeTipos.size === 0 || p.tipo.some(t => activeTipos.has(t));
      return matchSearch && matchId && matchGen && matchTipo;
    });

    document.getElementById('count').textContent = filtered.length;

    if (!filtered.length) {
      grid.innerHTML = '<div class="gc-empty">NO SE ENCONTRARON POKÃ‰MON</div>';
      return;
    }

    grid.innerHTML = filtered.map((p, i) => {
      const tiposBadges = p.tipo.map(t =>
        `<span class="gc-tipo" style="background:${TIPO_COLORS[t] || '#888'}">${t.toUpperCase()}</span>`
      ).join('');

      const ataquesTags = (p.ataques || []).map(a =>
        `<span class="gc-ataque">${a}</span>`
      ).join('');

      // nombre escapado para uso seguro en atributo onclick
      const nombreEscaped = p.nombre.replace(/'/g, "\\'");

      return `
        <div class="gc-card" data-pkid="${p.id}" style="animation-delay:${i * 0.04}s" onclick="openModal(${p.id})">
          <div class="gc-card-bar">
            <span class="gc-card-num">NO.${String(p.id).padStart(3,'0')}</span>
            <span class="gc-card-gen">GEN ${p.generacion}</span>
          </div>
          <div class="gc-card-img">
            <img data-id="${p.id}" data-nombre="${p.nombre}" alt="${p.nombre}" src=""/>
            <button class="gc-shiny-btn" title="Ver shiny" onclick="event.stopPropagation();toggleShiny(this,${p.id},'${nombreEscaped}')">âœ¨</button>
            <div class="gc-sound">ğŸ”Š</div>
          </div>
          <div class="gc-card-body">
            <div class="gc-card-name">${p.nombre}</div>
            <div class="gc-tipos">${tiposBadges}</div>
            <div class="gc-ataques">${ataquesTags}</div>
          </div>
          <div class="gc-region">${p.region || ''}</div>
        </div>`;
    }).join('');

    // Cargar sprites de Showdown para todos los PokÃ©mon del grid
    grid.querySelectorAll('img[data-id]').forEach(img => {
      const id     = parseInt(img.dataset.id);
      const nombre = img.dataset.nombre || img.alt;
      // Aplicar tamaÃ±o custom si existe en sprite_sizes.json
      const sizes = SPRITE_SIZES[String(id)];
      if (sizes && sizes.card) {
        img.style.width  = sizes.card + 'px';
        img.style.height = sizes.card + 'px';
      }
      setSpriteWithFallback(img, id, nombre);
    });
  }

  // â”€â”€ Event listeners de filtros â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  document.querySelectorAll('.gc-btn[data-filter^="gen:"]').forEach(btn => {
    btn.addEventListener('click', () => {
      const gen = parseInt(btn.dataset.filter.split(':')[1]);
      if (activeGens.has(gen)) {
        activeGens.clear();
        btn.classList.remove('active');
      } else {
        activeGens.clear();
        document.querySelectorAll('.gc-btn[data-filter^="gen:"]').forEach(b => b.classList.remove('active'));
        activeGens.add(gen);
        btn.classList.add('active');
      }
      render();
    });
  });

  document.querySelectorAll('.gc-tipo-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const tipo = btn.dataset.filter.split(':')[1];
      if (activeTipos.has(tipo)) {
        activeTipos.delete(tipo);
        btn.classList.remove('active');
      } else {
        if (activeTipos.size >= 2) {
          const primero = activeTipos.values().next().value;
          activeTipos.delete(primero);
          document.querySelector(`.gc-tipo-btn[data-filter="tipo:${primero}"]`)?.classList.remove('active');
        }
        activeTipos.add(tipo);
        btn.classList.add('active');
      }
      render();
    });
  });

  document.getElementById('search').addEventListener('input', e => {
    currentSearch = e.target.value;
    render();
  });

  document.getElementById('searchId').addEventListener('input', e => {
    currentSearchId = e.target.value.trim();
    render();
  });

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // PERFILES y CURIOSIDADES â€” cargados desde JSON
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  let PERFILES = {};
  let CURIOSIDADES = {};

  // â”€â”€ Stats helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const MAX_STAT = 255;
  const STAT_LABELS = {
    ps:'PS', ataque:'ATAQUE', defensa:'DEFENSA',
    atesp:'AT.ESP', defesp:'DEF.ESP', velocidad:'VELOCIDAD'
  };
  function getStatClass(v) {
    if (v < 50)  return 'stat-low';
    if (v < 80)  return 'stat-mid';
    if (v < 110) return 'stat-high';
    return 'stat-great';
  }
  function getStatNumColor(v) {
    if (v < 50)  return '#e05050';
    if (v < 80)  return '#d4a020';
    if (v < 110) return '#40a840';
    return '#2288CC';
  }
  function renderStats(stats) {
    const c = document.getElementById('modalStats');
    if (!stats) { c.innerHTML = '<div style="color:var(--muted);font-family:\'Press Start 2P\',monospace;font-size:0.38rem;padding:0.5rem 0">SIN DATOS</div>'; return; }
    const total = Object.values(stats).reduce((a,b)=>a+b,0);
    c.innerHTML = Object.entries(stats).map(([k,v]) => `
      <div class="modal-stat">
        <div class="modal-stat-row">
          <span class="modal-stat-lbl">${STAT_LABELS[k]||k.toUpperCase()}</span>
          <div class="modal-stat-bar-wrap">
            <div class="modal-stat-bar-fill ${getStatClass(v)}" data-target="${Math.min((v/MAX_STAT)*100,100).toFixed(1)}%" style="width:0%"></div>
          </div>
          <span class="modal-stat-num" style="color:${getStatNumColor(v)}">${v}</span>
        </div>
      </div>`).join('') +
      `<div class="modal-stat-total">
        <span class="modal-stat-total-lbl">TOTAL</span>
        <span class="modal-stat-total-num">${total}</span>
      </div>`;
    setTimeout(() => {
      c.querySelectorAll('.modal-stat-bar-fill').forEach(b => b.style.width = b.dataset.target);
    }, 80);
  }

  // â”€â”€ Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  let currentModalId   = null;
  let currentModalName = null;

  function openModal(id) {
    const p = allPokemons.find(x => x.id === id);
    if (!p) return;
    currentModalId   = id;
    currentModalName = p.nombre;

    if (currentAudio) { currentAudio.pause(); currentAudio.currentTime = 0; }
    const audio = new Audio(CRY_URL(id));
    currentAudio = audio;
    audio.play().catch(() => {});

    document.getElementById('modalBarTitle').textContent = `INFO. POKÃ‰MON â€” ${p.nombre.toUpperCase()}`;
    modalIsShiny = false;
    document.getElementById('modalShinyBtn').classList.remove('active');
    document.getElementById('modalLoader').classList.add('visible');
    document.getElementById('modalSprite').closest('.modal-sprite-wrap').classList.remove('shiny');
    document.getElementById('modalShinyBtn').title = 'Ver shiny';

    const spriteEl = document.getElementById('modalSprite');
    spriteEl.dataset.pkid = id;
    spriteEl.alt = p.nombre;
    // Aplicar tamaÃ±o custom modal si existe en sprite_sizes.json
    const customSizes = SPRITE_SIZES[String(id)];
    if (customSizes && customSizes.modal) {
      spriteEl.style.width  = customSizes.modal + 'px';
      spriteEl.style.height = customSizes.modal + 'px';
    } else {
      spriteEl.style.width  = '170px';
      spriteEl.style.height = '170px';
    }
    setSpriteWithFallback(spriteEl, p.id, p.nombre, document.getElementById('modalLoader'));

    document.getElementById('modalNum').textContent = `NO.${String(p.id).padStart(3,'0')}`;
    document.getElementById('modalName').textContent = p.nombre;
    document.getElementById('modalNameNum').textContent = `NO.${String(p.id).padStart(3,'0')}`;
    document.getElementById('modalRegion').textContent = p.region || 'â€”';
    document.getElementById('modalGen').textContent = `GEN ${p.generacion}`;

    renderStats(p.stats || null);

    const perf = PERFILES[String(p.id)] || {};
    const setField = (id, val, placeholder) => {
      const el = document.getElementById(id);
      if (val) { el.textContent = val; el.className = 'modal-perfil-value'; }
      else { el.textContent = placeholder; el.className = 'modal-perfil-value placeholder'; }
    };
    setField('modalAltura',      perf.altura,      'Pendiente de aÃ±adir');
    setField('modalPeso',        perf.peso,        'Pendiente de aÃ±adir');
    setField('modalEspecie',     perf.especie,     'Pendiente de aÃ±adir');
    setField('modalDescripcion', perf.descripcion, 'Sin descripciÃ³n registrada todavÃ­a.');

    document.getElementById('modalTipos').innerHTML = p.tipo.map(t =>
      `<span class="modal-tipo" style="background:${TIPO_COLORS[t] || '#888'}">${t.toUpperCase()}</span>`
    ).join('');

    document.getElementById('modalAtaques').innerHTML = (p.ataques || []).map(a =>
      `<span class="modal-ataque">${a}</span>`
    ).join('');

    const curiosidades = CURIOSIDADES[String(id)] || [];
    const container = document.getElementById('modalCuriosidades');
    if (curiosidades.length === 0) {
      container.innerHTML = '<div class="modal-no-curiosidades">Sin datos curiosos registrados todavÃ­a.</div>';
    } else {
      container.innerHTML = curiosidades.map(c =>
        `<div class="modal-curiosidad-item">
          <span class="modal-curiosidad-icon">${c.icon || 'â–¶'}</span>
          <span class="modal-curiosidad-text">${c.texto}</span>
        </div>`
      ).join('');
    }

    document.getElementById('modalOverlay').classList.add('open');
    document.body.style.overflow = 'hidden';
  }

  // â”€â”€ Shiny en modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  let modalIsShiny = false;

  function toggleModalShiny() {
    const btn  = document.getElementById('modalShinyBtn');
    const img  = document.getElementById('modalSprite');
    const wrap = img.closest('.modal-sprite-wrap');
    modalIsShiny = !modalIsShiny;
    if (modalIsShiny) {
      btn.classList.add('active');
      wrap.classList.add('shiny');
      btn.title = 'Ver normal';
      setShinyWithFallback(img, currentModalId, currentModalName, document.getElementById('modalLoader'));
    } else {
      btn.classList.remove('active');
      wrap.classList.remove('shiny');
      btn.title = 'Ver shiny';
      setSpriteWithFallback(img, currentModalId, currentModalName, document.getElementById('modalLoader'));
    }
  }

  function closeModal() {
    document.getElementById('modalOverlay').classList.remove('open');
    document.body.style.overflow = '';
    currentModalId   = null;
    currentModalName = null;
  }

  function closeModalOutside(e) {
    if (e.target === document.getElementById('modalOverlay')) closeModal();
  }

  // â”€â”€ Sprite Viewer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function openSpriteViewer() {
    if (!currentModalId) return;
    const p = allPokemons.find(x => x.id === currentModalId);
    const id = currentModalId;

    document.getElementById('svPokeName').textContent = p ? p.nombre.toUpperCase() : `#${id}`;

    setSpriteWithFallback(document.getElementById('svFront'), id, p ? p.nombre : '', document.getElementById('svFrontLoader'));
    setShinyWithFallback(document.getElementById('svShinyFront'), id, p ? p.nombre : '', document.getElementById('svShinyLoader'));

    document.getElementById('svOverlay').classList.add('open');
  }

  function closeSpriteViewer() {
    document.getElementById('svOverlay').classList.remove('open');
  }

  function closeSVOutside(e) {
    if (e.target === document.getElementById('svOverlay')) closeSpriteViewer();
  }

  document.addEventListener('keydown', e => {
    if (e.key === 'Escape') {
      closeSpriteViewer();
      closeModal();
    }
  });

  loadPokemons();
</script>
</body>
</html>
